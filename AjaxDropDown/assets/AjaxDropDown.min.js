/*!
 * AjaxDropDown v1.1.2 | Pawe≈Ç Bizley Brzozowski | https://github.com/bizley-code/Yii-AjaxDropDown
 */
!function(a){a.fn.ajaxDropDown=function(e){var n=a.extend(!0,{accl:"active",addc:"",dicl:"disabled",ercl:"",erst:"",hecl:"",hest:"",hicl:"hidden",locl:"",lost:"",mabe:"",maen:"",minq:0,name:"ajaxDropDown",nebe:"",necl:"",neen:"",nest:"",nrcl:"",nrst:"",pabe:"",paen:"",prbe:"",prcl:"",pren:"",prst:"",prba:"",recl:"",rest:"",rmcl:"",rmla:"",rmst:"",rscl:"",rsst:"",smod:!1,swcl:"",swst:"",trig:"",url:"",loca:{allr:"All records",rcon:"Records containing",mcha:"Type at least {NUM} character(s) to filter the results...",erro:"Error",prev:"prev",next:"next",nrec:"No matching records found"}},e),r="</li>",t='<li class="dropdown-header',o=' style="',l="</a></li>",s=this.find("ul.ajaxDropDownMenu"),p='<li class="ajaxDropDownLoading';""!==n.locl&&(p+=" "+n.locl),p+='"',""!==n.lost&&(p+=o+n.lost+'"'),p+=">"+n.prba+r;var d=t;""!==n.hecl&&(d+=" "+n.hecl),d+='"',""!==n.hest&&(d+=o+n.hest+'"'),d+=">";var c=n.loca.mcha.replace(/{NUM}/g,n.minq),D=t;""!==n.ercl&&(D+=" "+n.ercl),D+='"',""!==n.erst&&(D+=o+n.erst+'"'),D+=">"+n.loca.erro+r;var f=t;return""!==n.nrcl&&(f+=" "+n.nrcl),f+='"',""!==n.nrst&&(f+=o+n.nrst+'"'),f+=">"+n.loca.nrec+r,this.on(n.trig,function(){if(0===s.find("li.ajaxDropDownPages").length){var e=a(this).find("button.ajaxDropDownToggle").data("page");e=1*e;var t=!1,x=d+n.pabe+'<span class="ajaxDropDownPageNumber">'+e+'</span>/<span class="ajaxDropDownTotalPages">1</span>',g=x;g+=n.paen+n.loca.allr+'</li><li class="divider"></li>'+p;var w=a(this).find("input[type=text]").val();n.minq>0?w.length>=n.minq?(g=x,g+=n.paen+n.loca.rcon+" <strong>"+w,g+='</strong></li><li class="divider"></li>'+p,t=!0):g=d+c+r:t=!0,s.html(g),t&&a.post(n.url,{query:w,page:e}).fail(function(){s.append(D)}).done(function(e){var r=a.parseJSON(e);if(void 0===r.total&&(r.total=1),void 0===r.page&&(r.page=1),r.data.length){s.find("span.ajaxDropDownTotalPages").text(r.total);for(i in r.data){var t='<li class="ajaxDropDownPages ajaxDropDownPage'+r.page+" ajaxDropDownRecord"+r.data[i].id;""!==n.recl&&(t+=" "+n.recl),s.parent().parent().parent().find("li.ajaxDropDownSelected"+r.data[i].id).length&&(t+=" "+n.accl),t+='"',""!==n.rest&&(t+=o+n.rest+'"'),t+='><a href="#" class="ajaxDropDownResult" data-id="'+r.data[i].id+'">',r.data[i].mark&&(t+=n.mabe),t+=r.data[i].value,r.data[i].mark&&(t+=n.maen),t+=l,s.append(t)}if(r.total>1){var p='<li class="divider ajaxDropDownInfo"></li><li class="ajaxDropDownInfo';""!==n.swcl&&(p+=" "+n.swcl),p+='"',""!==n.swst&&(p+=o+n.swst+'"'),p+='><a href="#" class="ajaxDropDownPrev',""!==n.prcl&&(p+=" "+n.prcl),1===r.page&&(p+=" "+n.dicl),p+='"',""!==n.prst&&(p+=o+n.prst+'"'),p+=">"+n.prbe+n.loca.prev+n.pren+'</a><a href="#" class="ajaxDropDownNext',""!==n.necl&&(p+=" "+n.necl),r.page===r.total&&(p+=" "+n.dicl),p+='"',""!==n.nest&&(p+=o+n.nest+'"'),p+=">"+n.nebe+n.loca.next+n.neen+l,s.append(p)}}else s.append(f)}).always(function(){a("li.ajaxDropDownLoading").remove()})}}),this.on("click","a.ajaxDropDownNext",function(e){e.preventDefault(),e.stopPropagation(),s.find("a.ajaxDropDownPrev").removeClass(n.dicl),s.find("a.ajaxDropDownNext").addClass(n.dicl);var r=s.parent().find("button.ajaxDropDownToggle").data("page");if(r=1*r+1,s.find("li.ajaxDropDownPage"+r).length)s.find("li.ajaxDropDownPages").addClass(n.hicl),s.find("li.ajaxDropDownPage"+r).removeClass(n.hicl),s.find("a.ajaxDropDownNext").removeClass(n.dicl);else{var t=s.parent().parent().find("input[type=text]").val();a.post(n.url,{query:t,page:r}).fail(function(){s.append(D)}).done(function(e){var t=a.parseJSON(e);if(t.data.length){s.find(".ajaxDropDownPages").addClass(n.hicl),void 0===t.total&&(t.total=1),void 0===t.page&&(t.page=1);for(i in t.data){var p='<li class="ajaxDropDownPages ajaxDropDownPage'+t.page+" ajaxDropDownRecord"+t.data[i].id;""!==n.recl&&(p+=" "+n.recl),s.parent().parent().parent().find("li.ajaxDropDownSelected"+t.data[i].id).length&&(p+=" "+n.accl),p+='"',""!==n.rest&&(p+=o+n.rest+'"'),p+='><a href="#" class="ajaxDropDownResult" data-id="'+t.data[i].id+'">',t.data[i].mark&&(p+=n.mabe),p+=t.data[i].value,t.data[i].mark&&(p+=n.maen),p+=l,s.find(".divider.ajaxDropDownInfo").before(p)}t.page<t.total?s.find("a.ajaxDropDownNext").removeClass(n.dicl):r=t.total}else s.append(f)})}s.parent().find("button.ajaxDropDownToggle").data("page",r),s.find("span.ajaxDropDownPageNumber").text(r)}),this.on("click","a.ajaxDropDownPrev",function(a){a.preventDefault(),a.stopPropagation(),s.find("a.ajaxDropDownNext").removeClass(n.dicl),s.find("a.ajaxDropDownPrev").addClass(n.dicl);var e=s.parent().find("button.ajaxDropDownToggle").data("page");e=1*e-1,1>e&&(e=1),s.find("li.ajaxDropDownPages").addClass(n.hicl),s.find("li.ajaxDropDownPage"+e).removeClass(n.hicl),e>1&&s.find("a.ajaxDropDownPrev").removeClass(n.dicl),s.parent().find("button.ajaxDropDownToggle").data("page",e),s.find("span.ajaxDropDownPageNumber").text(e)}),this.on("keyup","input[type=text]",function(){a(this).parent().find("button.ajaxDropDownToggle").data("page",1),a(this).parent().find("ul.ajaxDropDownMenu").find("li.ajaxDropDownPages").remove()}),this.on("click","a.ajaxDropDownResult",function(e){e.preventDefault();var r=a(this).data("id"),t=a(this).html(),l=a(this).parent().parent().parent().parent().parent().find("ul.ajaxDropDownResults"),i="[]";if(n.smod&&(l.html(""),a(this).parent().parent().find("li.ajaxDropDownPages").removeClass(n.accl),i=""),a(this).parent().hasClass(n.accl))a(this).parent().removeClass(n.accl),l.find("li.ajaxDropDownSelected"+r).remove();else{a(this).parent().addClass(n.accl),n.smod&&(i="");var s='<li class="ajaxDropDownSelected'+r;if(""!==n.rscl&&(s+=" "+n.rscl),s+='"',""!==n.rsst&&(s+=o+n.rsst+'"'),s+='><a href="#" class="ajaxDropDownRemove',""!==n.rmcl&&(s+=" "+n.rmcl),s+='"',""!==n.rmst&&(s+=o+n.rmst+'"'),s+=' data-id="'+r+'">'+n.rmla+"</a>",""!==n.addc){var p=n.addc.replace(/{ID}/g,r);p=p.replace(/{VALUE}/g,t),s+=p}s+=t+'<input type="hidden" name="'+n.name+i+'" value="'+r+'" /></li>',l.append(s)}}),this.on("click","a.ajaxDropDownRemove",function(e){e.preventDefault(),a(this).parent().parent().parent().find("li.ajaxDropDownRecord"+a(this).data("id")).removeClass(n.accl),a(this).parent().remove()}),this}}(jQuery);